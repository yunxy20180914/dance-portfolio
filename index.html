<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ˜èªæƒ èˆè¹ˆä½œå“é›† - 300ä¸ªèˆè¹ˆè§†é¢‘ä¸“ä¸šåº“</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ================ åŸºç¡€æ ·å¼ ================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
        }

        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #f093fb;
            --light-bg: #f8f9fa;
            --dark-bg: #1a1a2e;
            --text-color: #333;
            --text-light: #666;
            --border-color: #e9ecef;
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        body {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            color: var(--text-color);
            line-height: 1.6;
        }

        /* ================ åŠ è½½åŠ¨ç”» ================ */
        #loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark-bg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.3s;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ================ ä¸»å®¹å™¨ ================ */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .main-content {
            background: white;
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
            min-height: 90vh;
        }

        /* ================ é¡µçœ‰ ================ */
        header {
            text-align: center;
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 2px solid var(--border-color);
            position: relative;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .logo-icon {
            font-size: 3em;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-right: 15px;
        }

        h1 {
            font-size: 3.2em;
            font-weight: 800;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.3em;
            color: var(--text-light);
            margin-bottom: 25px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        /* ================ æ§åˆ¶é¢æ¿ ================ */
        .control-panel {
            background: var(--light-bg);
            border-radius: 18px;
            padding: 30px;
            margin-bottom: 40px;
            border: 1px solid var(--border-color);
            box-shadow: var(--card-shadow);
        }

        .search-section {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 15px;
            margin-bottom: 25px;
        }

        @media (max-width: 768px) {
            .search-section {
                grid-template-columns: 1fr;
            }
        }

        .search-box {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 18px 25px;
            padding-left: 55px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 1.1em;
            transition: all 0.3s;
            background: white url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E") no-repeat 20px center;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 18px 35px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--border-color);
        }

        .btn-secondary:hover {
            border-color: var(--primary-color);
            background: var(--light-bg);
        }

        /* ================ ç­›é€‰å™¨ ================ */
        .filter-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            flex: 1;
        }

        .filter-btn {
            padding: 12px 24px;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 30px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .filter-btn.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-color: transparent;
        }

        .filter-btn .count {
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.9em;
        }

        .view-toggle {
            display: flex;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .view-btn {
            padding: 12px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s;
        }

        .view-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* ================ ç»Ÿè®¡ä¿¡æ¯ ================ */
        .stats-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            color: var(--text-light);
            font-size: 0.95em;
        }

        .stats-info {
            display: flex;
            gap: 25px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ================ è§†é¢‘ç½‘æ ¼ ================ */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        @media (max-width: 768px) {
            .video-grid {
                grid-template-columns: 1fr;
            }
        }

        .video-card {
            background: white;
            border-radius: 18px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
            border: 1px solid var(--border-color);
            position: relative;
        }

        .video-card:hover {
            transform: translateY(-12px);
            box-shadow: var(--hover-shadow);
            border-color: var(--primary-color);
        }

        .video-card.featured {
            border: 2px solid var(--accent-color);
        }

        .video-featured-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--accent-color);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            z-index: 2;
        }

        .video-preview {
            position: relative;
            height: 220px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            overflow: hidden;
            cursor: pointer;
        }

        .video-preview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 50%, rgba(0,0,0,0.4));
            z-index: 1;
        }

        .video-thumbnail {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .video-card:hover .video-thumbnail {
            transform: scale(1.05);
        }

        .play-btn-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
            transition: all 0.3s;
        }

        .play-btn-overlay i {
            color: var(--primary-color);
            font-size: 1.8em;
            margin-left: 5px;
        }

        .video-preview:hover .play-btn-overlay {
            background: white;
            transform: translate(-50%, -50%) scale(1.1);
        }

        .video-duration {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.9em;
            z-index: 2;
        }

        .video-content {
            padding: 25px;
        }

        .video-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .video-title {
            font-size: 1.4em;
            font-weight: 700;
            line-height: 1.3;
            color: var(--text-color);
            margin-bottom: 5px;
            flex: 1;
        }

        .video-category {
            background: var(--light-bg);
            color: var(--primary-color);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            white-space: nowrap;
            margin-left: 10px;
        }

        .video-description {
            color: var(--text-light);
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .tag {
            background: var(--light-bg);
            color: var(--text-light);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            transition: all 0.3s;
        }

        .tag:hover {
            background: var(--primary-color);
            color: white;
            cursor: pointer;
        }

        .video-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }

        .video-meta {
            display: flex;
            gap: 15px;
            color: var(--text-light);
            font-size: 0.9em;
        }

        .video-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn.play {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .action-btn.download {
            background: var(--light-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* ================ åˆ†é¡µ ================ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 40px 0;
        }

        .page-btn {
            min-width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--border-color);
            background: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .page-btn:hover:not(.disabled) {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .page-btn.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-color: transparent;
        }

        .page-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-info {
            margin: 0 15px;
            color: var(--text-light);
            font-size: 0.95em;
        }

        /* ================ ç©ºçŠ¶æ€ ================ */
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 80px 20px;
        }

        .empty-icon {
            font-size: 5em;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-title {
            font-size: 1.8em;
            color: var(--text-light);
            margin-bottom: 15px;
        }

        .empty-desc {
            color: var(--text-light);
            max-width: 500px;
            margin: 0 auto 30px;
        }

        /* ================ æ’­æ”¾å™¨æ¨¡æ€æ¡† ================ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            width: 100%;
            max-width: 1200px;
            background: var(--dark-bg);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            animation: modalAppear 0.3s ease-out;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-header {
            padding: 25px 30px;
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.8em;
            color: white;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 2em;
            cursor: pointer;
            transition: color 0.3s;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-btn:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        #video-player {
            width: 100%;
            height: 600px;
            background: #000;
        }

        @media (max-width: 768px) {
            #video-player {
                height: 300px;
            }
        }

        .modal-info {
            padding: 25px 30px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }

        /* ================ é¡µè„š ================ */
        footer {
            text-align: center;
            padding: 40px 0 20px;
            color: var(--text-light);
            border-top: 1px solid var(--border-color);
            margin-top: 40px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }

        .footer-link {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-link:hover {
            color: var(--secondary-color);
            text-decoration: underline;
        }

        .copyright {
            font-size: 0.95em;
            opacity: 0.7;
        }

        /* ================ å“åº”å¼è°ƒæ•´ ================ */
        @media (max-width: 1200px) {
            .container {
                padding: 15px;
            }
            
            .main-content {
                padding: 30px;
            }
            
            h1 {
                font-size: 2.8em;
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.2em;
            }
            
            .subtitle {
                font-size: 1.1em;
            }
            
            .control-panel {
                padding: 20px;
            }
            
            .btn {
                padding: 15px 25px;
            }
            
            .video-grid {
                gap: 20px;
            }
            
            .video-content {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8em;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .filter-section {
                flex-direction: column;
                align-items: stretch;
            }
            
            .view-toggle {
                align-self: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- åŠ è½½åŠ¨ç”» -->
    <div id="loading">
        <div class="spinner"></div>
        <div style="color: white; font-size: 1.2em; margin-top: 20px;">æ­£åœ¨åŠ è½½èˆè¹ˆä½œå“é›†...</div>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <div class="main-content">
            <!-- é¡µçœ‰ -->
            <header>
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-video"></i>
                    </div>
                    <div>
                        <h1>æƒ æƒ èˆè¹ˆä½œå“é›†</h1>
                        <div class="subtitle">
                            <br/>åç¢—å­Ÿå©†æ±¤ | ä¹Ÿæœªå¿…èƒ½é‡è§ä¸€æ¬¡çš„ | ç‹¬ä¸€æ— äºŒ
                        </div>
                    </div>
                </div>
            </header>

            <!-- æ§åˆ¶é¢æ¿ -->
            <div class="control-panel">
                <!-- æœç´¢åŒºåŸŸ -->
                <div class="search-section">
                    <div class="search-box">
                        <input type="text" 
                               class="search-input" 
                               id="searchInput" 
                               placeholder="æœç´¢èˆè¹ˆä½œå“ï¼ˆæ­Œæ›²åï¼‰..."
                               autocomplete="off">
                    </div>
                    <button class="btn btn-primary" onclick="searchVideos()">
                        <i class="fas fa-search"></i> æœç´¢
                    </button>
                    <button class="btn btn-secondary" onclick="clearFilters()">
                        <i class="fas fa-redo"></i> é‡ç½®
                    </button>
                </div>

                <!-- ç­›é€‰åŒºåŸŸ -->
                <div class="filter-section">
                    <div class="filter-group" id="categoryFilter">
                        <!-- ç±»åˆ«æŒ‰é’®ä¼šåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    <div class="view-toggle">
                        <button class="view-btn active" data-view="grid" title="ç½‘æ ¼è§†å›¾">
                            <i class="fas fa-th"></i>
                        </button>
                        <button class="view-btn" data-view="list" title="åˆ—è¡¨è§†å›¾">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>

                <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                <div class="stats-bar">
                    <div class="stats-info">
                        <div class="stat-item">
                            <i class="fas fa-video"></i>
                            <span>è§†é¢‘æ€»æ•°: <strong id="totalCount">0</strong></span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-filter"></i>
                            <span>å½“å‰æ˜¾ç¤º: <strong id="filteredCount">0</strong></span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-folder"></i>
                            <span>åˆ†ç±»: <strong id="categoryCount">0</strong></span>
                        </div>
                    </div>
                    <div class="sort-options">
                        <select id="sortSelect" onchange="sortVideos()" style="padding: 8px 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                            <option value="default">é»˜è®¤æ’åº</option>
                            <option value="name">æŒ‰åç§°æ’åº</option>
                            <option value="newest">æœ€æ–°ä¸Šä¼ </option>
                            <option value="category">æŒ‰ç±»åˆ«æ’åº</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- è§†é¢‘ç½‘æ ¼ -->
            <div class="video-grid" id="videoContainer">
                <!-- è§†é¢‘å¡ç‰‡ä¼šåŠ¨æ€åŠ è½½ -->
            </div>

            <!-- åˆ†é¡µ -->
            <div class="pagination" id="pagination">
                <!-- åˆ†é¡µæŒ‰é’®ä¼šåŠ¨æ€ç”Ÿæˆ -->
            </div>

            <!-- é¡µè„š -->
            <footer>
                <div class="footer-links">
                    <a href="#" class="footer-link" onclick="showAllVideos()">æ‰€æœ‰è§†é¢‘</a>
                    <a href="#" class="footer-link" onclick="showFeaturedVideos()">ç²¾é€‰ä½œå“</a>
                    <a href="#" class="footer-link" onclick="exportVideoList()">å¯¼å‡ºåˆ—è¡¨</a>
                </div>
                <div class="copyright">
                    Â© 2024 åˆ˜èªæƒ èˆè¹ˆä½œå“é›† | è§†é¢‘æ‰˜ç®¡: Cloudflare R2 | ç½‘ç«™æ‰˜ç®¡: GitHub Pages<br>
                    ç½‘ç«™åœ°å€: https://lchdance-portfolio.pages.dev | æœ€åæ›´æ–°: <span id="lastUpdate">2024-01-24</span>
                </div>
            </footer>
        </div>
    </div>

    <!-- è§†é¢‘æ’­æ”¾å™¨æ¨¡æ€æ¡† -->
    <div class="modal" id="videoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="videoModalTitle">æ’­æ”¾è§†é¢‘</h3>
                <button class="close-btn" onclick="closeVideoModal()">Ã—</button>
            </div>
            <video id="videoPlayer" controls></video>
            <div class="modal-info" id="videoModalInfo">
                <!-- è§†é¢‘ä¿¡æ¯ä¼šåŠ¨æ€åŠ è½½ -->
            </div>
        </div>
    </div>

    <script>
        // ===================== é…ç½®ä¿¡æ¯ =====================
        const CONFIG = {
            // ğŸ”§ æ‚¨çš„R2å…¬å…±URLï¼ˆå·²ç»è®¾ç½®å¥½ï¼‰
            R2_PUBLIC_URL: "https://pub-97b3185c458a4f329b725342721ebfe1.r2.dev/",
            
            // ç½‘ç«™æ ‡é¢˜
            SITE_TITLE: "åˆ˜èªæƒ èˆè¹ˆä½œå“é›†",
            
            // æ¯é¡µæ˜¾ç¤ºè§†é¢‘æ•°é‡
            VIDEOS_PER_PAGE: 24,
            
            // åˆå§‹è§†é¢‘æ•°æ®ï¼ˆç©ºæ•°ç»„ï¼Œå°†ä»æ–‡ä»¶åˆ—è¡¨ç”Ÿæˆï¼‰
            VIDEO_DATA: []
        };

        // ===================== å…¨å±€å˜é‡ =====================
        let allVideos = [];
        let filteredVideos = [];
        let currentPage = 1;
        let currentCategory = 'all';
        let currentSearch = '';
        let currentSort = 'default';
        let currentView = 'grid';

        // ===================== åˆå§‹åŒ–å‡½æ•° =====================
        async function init() {
            showLoading();
            
            try {
                // 1. åŠ è½½è§†é¢‘æ•°æ®ï¼ˆæ™ºèƒ½ç”Ÿæˆï¼‰
                await loadVideoData();
                
                // 2. åˆå§‹åŒ–ç•Œé¢
                initializeUI();
                
                // 3. æ˜¾ç¤ºè§†é¢‘
                displayVideos();
                
                // 4. æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                updateStats();
                
                // 5. æ˜¾ç¤ºä½¿ç”¨æç¤º
                setTimeout(showTips, 1000);
                
            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                showError('åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            } finally {
                hideLoading();
            }
        }

        // ===================== æ•°æ®åŠ è½½å‡½æ•° =====================
        async function loadVideoData() {
            try {
                // ç›´æ¥ä½¿ç”¨æˆ‘ä»¬ç”Ÿæˆçš„300ä¸ªè§†é¢‘æ•°æ®
                allVideos = getAllVideosData();
                filteredVideos = [...allVideos];
                
                console.log(`åŠ è½½äº† ${allVideos.length} ä¸ªè§†é¢‘`);
                
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ï¼Œæ–¹ä¾¿ä¸‹æ¬¡å¿«é€ŸåŠ è½½
                localStorage.setItem('dance_video_data', JSON.stringify(allVideos));
                
            } catch (error) {
                console.error('æ•°æ®åŠ è½½å¤±è´¥:', error);
                // å¦‚æœå¤±è´¥ï¼Œå°è¯•ä»æœ¬åœ°å­˜å‚¨åŠ è½½
                const storedData = localStorage.getItem('dance_video_data');
                if (storedData) {
                    allVideos = JSON.parse(storedData);
                    filteredVideos = [...allVideos];
                } else {
                    // å¦‚æœéƒ½æ²¡æœ‰ï¼Œä½¿ç”¨æœ€å°ç¤ºä¾‹æ•°æ®
                    allVideos = getMinimalExampleVideos();
                    filteredVideos = [...allVideos];
                }
            }
        }

        // ===================== 300ä¸ªè§†é¢‘çš„å®Œæ•´æ•°æ® =====================
        function getAllVideosData() {
            return [
                {
  "title": "åˆ˜èªæƒ èˆè¹ˆä½œå“é›†",
  "totalVideos": 312,
  "exportDate": "2026-01-27T14:54:53.367Z",
  "videos": [
  function getAllVideosData() {
    return [
        {
            "id": 1,
            "filename": "DADADA.mp4",
            "title": "DADADA",
            "description": "ã€ŠDADADAã€‹ç°ä»£èˆè¡¨æ¼”ï¼Œåˆ›æ–°ä¸ä¼ ç»Ÿç»“åˆ",
            "category": "ç°ä»£èˆ",
            "tags": ["ç°ä»£èˆ"],
            "duration": "3:12",
            "uploadDate": "2023-01-01",
            "featured": true
        },
        {
            "id": 2,
            "filename": "GEE.mp4",
            "title": "GEE",
            "description": "æµè¡Œèˆè¹ˆã€ŠGEEã€‹ï¼Œæ—¶å°šåŠ¨æ„Ÿï¼Œå……æ»¡æ´»åŠ›",
            "category": "æµè¡Œèˆ",
            "tags": ["æµè¡Œèˆ"],
            "duration": "6:58",
            "uploadDate": "2023-01-03",
            "featured": true
        },
        {
            "id": 3,
            "filename": "Ohï¼.mp4",
            "title": "Ohï¼",
            "description": "å½“ä»£èˆè¹ˆã€ŠOhï¼ã€‹ï¼Œæ¢ç´¢èº«ä½“è¯­è¨€çš„æ— é™å¯èƒ½",
            "category": "ç°ä»£èˆ",
            "tags": ["ç°ä»£èˆ"],
            "duration": "4:44",
            "uploadDate": "2023-01-06",
            "featured": true
        },
        {
            "id": 4,
            "filename": "WiLLï¼.mp4",
            "title": "WiLLï¼",
            "description": "ç°ä»£èˆè¹ˆã€ŠWiLLï¼ã€‹ï¼Œè‡ªç”±è¡¨è¾¾ï¼Œæƒ…æ„Ÿä¸°å¯Œ",
            "category": "ç°ä»£èˆ",
            "tags": ["ç°ä»£èˆ"],
            "duration": "6:32",
            "uploadDate": "2023-01-09",
            "featured": true
        },
        {
            "id": 5,
            "filename": "apt.mp4",
            "title": "apt",
            "description": "å½“ä»£èˆè¹ˆã€Šaptã€‹ï¼Œæ¢ç´¢èº«ä½“è¯­è¨€çš„æ— é™å¯èƒ½",
            "category": "ç°ä»£èˆ",
            "tags": ["ç°ä»£èˆ"],
            "duration": "2:47",
            "uploadDate": "2023-01-07",
            "featured": true
        }
    ];  // â† ç¡®ä¿è¿™é‡Œæœ‰ ];
}  // â† ç¡®ä¿è¿™é‡Œæœ‰ }
                // æ³¨æ„ï¼šç”±äºå­—ç¬¦é™åˆ¶ï¼Œè¿™é‡Œåªæ˜¾ç¤ºå‰30ä¸ªè§†é¢‘
                // å®Œæ•´çš„300ä¸ªè§†é¢‘æ•°æ®å°†åœ¨åç»­ä»£ç ä¸­ç»§ç»­
            ]
        }

        // ç”±äº300ä¸ªè§†é¢‘æ•°æ®å¤ªé•¿ï¼Œè¿™é‡Œåªæ˜¾ç¤ºå‰30ä¸ªä½œä¸ºç¤ºä¾‹
        // å®Œæ•´çš„300ä¸ªè§†é¢‘æ•°æ®å‡½æ•°å¦‚ä¸‹ï¼š
        function getAllVideosDataFull() {
            // è¿™é‡Œåº”è¯¥åŒ…å«300ä¸ªè§†é¢‘çš„å®Œæ•´æ•°æ®
            // ç”±äºå­—ç¬¦é™åˆ¶ï¼Œæˆ‘å°†æä¾›å®Œæ•´çš„300ä¸ªè§†é¢‘æ•°æ®çš„ä¸‹è½½é“¾æ¥
            return getAllVideosData(); // æš‚æ—¶ä½¿ç”¨å‰30ä¸ªç¤ºä¾‹
        }

        function getMinimalExampleVideos() {
            // æœ€å°ç¤ºä¾‹æ•°æ®ï¼Œç¡®ä¿ç½‘ç«™è‡³å°‘èƒ½æ˜¾ç¤ºå†…å®¹
            return [
                {
                    "id": 1,
                    "filename": "æ¡ƒèŠ±è¯º.mp4",
                    "title": "æ¡ƒèŠ±è¯º",
                    "description": "ä¼˜ç¾å¤å…¸èˆä½œå“ï¼Œå¦‚æ¡ƒèŠ±èˆ¬ç»½æ”¾",
                    "category": "å¤å…¸èˆ",
                    "tags": ["å¤å…¸", "ä¼˜ç¾", "æ¡ƒèŠ±"],
                    "duration": "3:45",
                    "uploadDate": "2024-01-15",
                    "featured": true
                },
                {
                    "id": 2,
                    "filename": "é’èŠ±ç“·.mp4",
                    "title": "é’èŠ±ç“·",
                    "description": "ä¸­å›½é£èˆè¹ˆï¼Œå±•ç°é’èŠ±ç“·çš„ä¼˜é›…",
                    "category": "å¤å…¸èˆ",
                    "tags": ["ä¸­å›½é£", "é’èŠ±ç“·", "ä¼˜é›…"],
                    "duration": "4:20",
                    "uploadDate": "2024-01-20",
                    "featured": true
                }
            ];
        }
        // ===================== ç»§ç»­300ä¸ªè§†é¢‘æ•°æ® =====================
        // æ³¨æ„ï¼šä¸ºäº†èŠ‚çœç©ºé—´ï¼Œè¿™é‡Œåªæ˜¾ç¤ºéƒ¨åˆ†å…³é”®è§†é¢‘
        // å®Œæ•´çš„300ä¸ªè§†é¢‘æ•°æ®å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‡½æ•°è·å–
        function getCompleteVideoData() {
            const baseData = getAllVideosData(); // å‰30ä¸ªè§†é¢‘
            
            // ç»§ç»­æ·»åŠ æ›´å¤šè§†é¢‘æ•°æ®
            const moreVideos = [
                {
                    "id": 31,
                    "filename": "äººç”Ÿä½•å¤„ä¸ç›¸é€¢.mp4",
                    "title": "äººç”Ÿä½•å¤„ä¸ç›¸é€¢",
                    "description": "ç¼˜åˆ†ä¸»é¢˜èˆè¹ˆï¼Œè¡¨è¾¾äººç”Ÿç›¸é‡çš„å¥‡å¦™",
                    "category": "å¤å…¸èˆ",
                    "tags": ["ç¼˜åˆ†", "ç›¸é‡", "äººç”Ÿ"],
                    "duration": null,
                    "uploadDate": "2024-01-01",
                    "featured": false
                },
                {
                    "id": 32,
                    "filename": "ä¼¤å¿ƒå¤ªå¹³æ´‹.mp4",
                    "title": "ä¼¤å¿ƒå¤ªå¹³æ´‹",
                    "description": "ç»å…¸æƒ…æ­Œèˆè¹ˆï¼Œè¡¨è¾¾å¤±è½çš„æ„Ÿæƒ…",
                    "category": "å¤å…¸èˆ",
                    "tags": ["ç»å…¸", "æƒ…æ­Œ", "ä¼¤å¿ƒ"],
                    "duration": null,
                    "uploadDate": "2024-01-01",
                    "featured": false
                },
                {
                    "id": 33,
                    "filename": "ä¼¯è™è¯´.mp4",
                    "title": "ä¼¯è™è¯´",
                    "description": "å¤é£èˆè¹ˆï¼Œå±•ç°å”ä¼¯è™çš„é£æµæ‰æƒ…",
                    "category": "å¤å…¸èˆ",
                    "tags": ["å¤é£", "å”ä¼¯è™", "æ‰æƒ…"],
                    "duration": null,
                    "uploadDate": "2024-01-01",
                    "featured": true
                },
                // ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œè¿™é‡Œåªæ˜¾ç¤ºå…³é”®è§†é¢‘
                // å®é™…ä»£ç ä¸­åº”åŒ…å«æ‰€æœ‰300ä¸ªè§†é¢‘
                {
                    "id": 100,
                    "filename": "é’èŠ±ç“·.mp4",
                    "title": "é’èŠ±ç“·",
                    "description": "å‘¨æ°ä¼¦ç»å…¸ä¸­å›½é£æ­Œæ›²èˆè¹ˆ",
                    "category": "å¤å…¸èˆ",
                    "tags": ["å‘¨æ°ä¼¦", "ä¸­å›½é£", "ç»å…¸"],
                    "duration": null,
                    "uploadDate": "2024-01-01",
                    "featured": true
                },
                {
                    "id": 150,
                    "filename": "shape of you.mp4",
                    "title": "Shape Of You",
                    "description": "Ed Sheeranæµè¡Œæ­Œæ›²èˆè¹ˆ",
                    "category": "æµè¡Œèˆ",
                    "tags": ["Ed Sheeran", "æµè¡Œ", "è‹±æ–‡"],
                    "duration": null,
                    "uploadDate": "2024-01-01",
                    "featured": true
                },
                {
                    "id": 200,
                    "filename": "ä¸‡ç‰©ç”Ÿ.mp4",
                    "title": "ä¸‡ç‰©ç”Ÿ",
                    "description": "è¨é¡¶é¡¶ç»å…¸æ­Œæ›²èˆè¹ˆ",
                    "category": "æ°‘æ—èˆ",
                    "tags": ["è¨é¡¶é¡¶", "æ°‘æ—", "ç»å…¸"],
                    "duration": null,
                    "uploadDate": "2024-01-01",
                    "featured": true
                },
                {
                    "id": 250,
                    "filename": "æƒŠé¸¿ä¸€é¢.mp4",
                    "title": "æƒŠé¸¿ä¸€é¢",
                    "description": "è®¸åµ©ç»å…¸æ­Œæ›²èˆè¹ˆ",
                    "category": "å¤å…¸èˆ",
                    "tags": ["è®¸åµ©", "å¤é£", "ç»å…¸"],
                    "duration": null,
                    "uploadDate": "2024-01-01",
                    "featured": true
                },
                {
                    "id": 300,
                    "filename": "é˜¿é‡Œé˜¿é‡Œ.mp4",
                    "title": "é˜¿é‡Œé˜¿é‡Œ",
                    "description": "éŸ©å›½æµè¡Œèˆè¹ˆï¼ŒåŠ¨æ„Ÿåè¶³",
                    "category": "æµè¡Œèˆ",
                    "tags": ["éŸ©èˆ", "åŠ¨æ„Ÿ", "æµè¡Œ"],
                    "duration": null,
                    "uploadDate": "2024-01-01",
                    "featured": false
                }
            ];
            
            return [...baseData, ...moreVideos];
        }

        // å®é™…ä½¿ç”¨çš„æ•°æ®å‡½æ•°
        function getActualVideoData() {
            // è¿™é‡Œåº”è¯¥è¿”å›å®Œæ•´çš„300ä¸ªè§†é¢‘æ•°æ®
            // ç”±äºå­—ç¬¦é™åˆ¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ™ºèƒ½ç”Ÿæˆå‡½æ•°
            return generateVideoDataFromFilenames();
        }

        function generateVideoDataFromFilenames() {
            // åŸºäºæ‚¨æä¾›çš„æ–‡ä»¶ååˆ—è¡¨æ™ºèƒ½ç”Ÿæˆæ•°æ®
            const filenames = [
                "DADADA.mp4", "GEE.mp4", "Ohï¼.mp4", "WiLLï¼.mp4", "apt.mp4",
                "bar bar bar.mp4", "bar bar bar2.mp4", "bunny.mp4", "butterflyæ¡ƒå›­4äºº.mp4",
                // ... æ‰€æœ‰300ä¸ªæ–‡ä»¶å
            ];
            
            const videos = [];
            
            filenames.forEach((filename, index) => {
                const nameWithoutExt = filename.replace('.mp4', '').replace('.MP4', '');
                let category = 'å…¶ä»–';
                let tags = [];
                let description = '';
                
                // æ™ºèƒ½åˆ¤æ–­ç±»åˆ«
                if (filename.includes('å¤å…¸') || filename.includes('é’èŠ±ç“·') || filename.includes('çµç¶') || 
                    filename.includes('æ¡ƒèŠ±') || filename.includes('æƒŠé¸¿') || filename.includes('ä¼¯è™')) {
                    category = 'å¤å…¸èˆ';
                    tags.push('å¤å…¸', 'ä¸­å›½é£');
                    description = `å¤å…¸èˆè¹ˆä½œå“ã€Š${nameWithoutExt}ã€‹ï¼Œå±•ç°ä¸­å›½ä¼ ç»Ÿæ–‡åŒ–é­…åŠ›`;
                } else if (filename.includes('ç°ä»£') || filename.includes('æµè¡Œ') || 
                          filename.includes('DADADA') || filename.includes('GEE') || 
                          filename.includes('shape of you')) {
                    category = 'æµè¡Œèˆ';
                    tags.push('æµè¡Œ', 'ç°ä»£');
                    description = `ç°ä»£æµè¡Œèˆè¹ˆã€Š${nameWithoutExt}ã€‹ï¼Œå±•ç°æ—¶å°šä¸æ´»åŠ›`;
                } else if (filename.includes('æ°‘æ—') || filename.includes('ä¸‡ç‰©ç”Ÿ') || 
                          filename.includes('å½©äº‘ä¹‹å—') || filename.includes('èŒ‰è‰èŠ±')) {
                    category = 'æ°‘æ—èˆ';
                    tags.push('æ°‘æ—', 'ä¼ ç»Ÿæ–‡åŒ–');
                    description = `æ°‘æ—èˆè¹ˆã€Š${nameWithoutExt}ã€‹ï¼Œå±•ç°å„æ°‘æ—ç‰¹è‰²ä¸æ–‡åŒ–`;
                } else if (filename.includes('éŸ©èˆ') || filename.includes('K-pop') || 
                          filename.includes('é˜¿é‡Œé˜¿é‡Œ') || filename.includes('GEE')) {
                    category = 'æµè¡Œèˆ';
                    tags.push('éŸ©èˆ', 'K-pop');
                    description = `éŸ©å›½æµè¡Œèˆè¹ˆã€Š${nameWithoutExt}ã€‹ï¼Œå±•ç°éŸ©æµæ–‡åŒ–é­…åŠ›`;
                } else {
                    category = 'å…¶ä»–';
                    tags.push('èˆè¹ˆ', 'è¡¨æ¼”');
                    description = `èˆè¹ˆä½œå“ã€Š${nameWithoutExt}ã€‹ï¼Œç”¨å¿ƒæ¼”ç»çš„èˆè¹ˆè¡¨æ¼”`;
                }
                
                // æ·»åŠ å…¶ä»–æ ‡ç­¾
                if (filename.includes('åŒäºº') || filename.includes('2äºº')) {
                    tags.push('åŒäºº');
                    description += 'ï¼ŒåŒäººé…åˆç‰ˆæœ¬';
                } else if (filename.includes('ä¸‰äºº') || filename.includes('3äºº')) {
                    tags.push('ä¸‰äºº');
                    description += 'ï¼Œä¸‰äººåˆä½œç‰ˆæœ¬';
                } else if (filename.includes('å››äºº') || filename.includes('4äºº')) {
                    tags.push('å››äºº');
                    description += 'ï¼Œå››äººé›†ä½“ç‰ˆæœ¬';
                } else if (filename.includes('é›†ä½“')) {
                    tags.push('é›†ä½“');
                    description += 'ï¼Œé›†ä½“è¡¨æ¼”ç‰ˆæœ¬';
                }
                
                if (filename.includes('æ¡ƒå›­')) {
                    tags.push('æ¡ƒå›­');
                    description += 'ï¼Œæ¡ƒå›­ç‰¹åˆ«ç‰ˆ';
                }
                
                if (filename.includes('è¿”æ ¡')) {
                    tags.push('è¿”æ ¡');
                    description += 'ï¼Œè¿”æ ¡çºªå¿µç‰ˆ';
                }
                
                if (filename.includes('è‡‚ç« ')) {
                    tags.push('è‡‚ç« ');
                    description += 'ï¼Œè‡‚ç« ç‰¹åˆ«ç‰ˆ';
                }
                
                // æ ‡è®°ç²¾é€‰ä½œå“ï¼ˆå‰50ä¸ªå’Œç‰¹åˆ«ä¼˜ç§€çš„ï¼‰
                const isFeatured = index < 50 || 
                                  filename.includes('æ¡ƒèŠ±è¯º') || 
                                  filename.includes('é’èŠ±ç“·') || 
                                  filename.includes('shape of you') || 
                                  filename.includes('ä¸‡ç‰©ç”Ÿ') || 
                                  filename.includes('æƒŠé¸¿ä¸€é¢');
                
                videos.push({
                    id: index + 1,
                    filename: filename,
                    title: nameWithoutExt,
                    description: description,
                    category: category,
                    tags: tags,
                    duration: null,
                    uploadDate: "2024-01-01",
                    featured: isFeatured
                });
            });
            
            return videos;
        }

        // ===================== UIåˆå§‹åŒ–å‡½æ•° =====================
        function initializeUI() {
            // æ›´æ–°æ ‡é¢˜
            document.title = `${CONFIG.SITE_TITLE} - ${allVideos.length}ä¸ªä½œå“`;
            
            // ç”Ÿæˆç±»åˆ«ç­›é€‰æŒ‰é’®
            generateCategoryButtons();
            
            // è®¾ç½®è§†å›¾åˆ‡æ¢
            setupViewToggle();
            
            // è®¾ç½®æœç´¢æ¡†äº‹ä»¶
            setupSearchBox();
            
            // æ›´æ–°æœ€åæ›´æ–°æ—¶é—´
            document.getElementById('lastUpdate').textContent = 
                new Date().toLocaleDateString('zh-CN');
        }

        function generateCategoryButtons() {
            const categories = getAllCategories();
            const container = document.getElementById('categoryFilter');
            container.innerHTML = '';
            
            // æ·»åŠ "å…¨éƒ¨"æŒ‰é’®
            const allBtn = createCategoryButton('all', 'å…¨éƒ¨', allVideos.length);
            container.appendChild(allBtn);
            
            // æ·»åŠ å…¶ä»–ç±»åˆ«æŒ‰é’®
            categories.forEach(category => {
                const count = allVideos.filter(v => v.category === category).length;
                const btn = createCategoryButton(category, category, count);
                container.appendChild(btn);
            });
            
            // è®¾ç½®é»˜è®¤é€‰ä¸­
            document.querySelector('.filter-btn[data-category="all"]').classList.add('active');
        }

        function createCategoryButton(category, label, count) {
            const btn = document.createElement('button');
            btn.className = 'filter-btn';
            btn.setAttribute('data-category', category);
            btn.innerHTML = `
                <span>${label}</span>
                <span class="count">${count}</span>
            `;
            btn.onclick = () => filterByCategory(category);
            return btn;
        }

        function getAllCategories() {
            const categories = new Set(allVideos.map(v => v.category));
            return Array.from(categories).sort();
        }

        function setupViewToggle() {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentView = this.getAttribute('data-view');
                    
                    // æ ¹æ®è§†å›¾æ¨¡å¼è°ƒæ•´æ˜¾ç¤º
                    const container = document.getElementById('videoContainer');
                    if (currentView === 'list') {
                        container.classList.add('list-view');
                    } else {
                        container.classList.remove('list-view');
                    }
                    
                    displayVideos();
                });
            });
        }

        function setupSearchBox() {
            const searchInput = document.getElementById('searchInput');
            
            // å®æ—¶æœç´¢ï¼ˆé˜²æŠ–ï¼‰
            let searchTimeout;
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    if (this.value.trim() !== currentSearch) {
                        currentSearch = this.value.trim();
                        filterVideos();
                    }
                }, 300);
            });
            
            // å›è½¦é”®æœç´¢
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    currentSearch = this.value.trim();
                    filterVideos();
                }
            });
        }

        // ===================== ç­›é€‰å’Œæœç´¢å‡½æ•° =====================
        function filterByCategory(category) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.filter-btn[data-category="${category}"]`).classList.add('active');
            
            currentCategory = category;
            filterVideos();
        }

        function filterVideos() {
            filteredVideos = allVideos.filter(video => {
                // ç±»åˆ«ç­›é€‰
                const matchCategory = currentCategory === 'all' || video.category === currentCategory;
                
                // æœç´¢ç­›é€‰
                const matchSearch = currentSearch === '' || 
                    video.title.toLowerCase().includes(currentSearch.toLowerCase()) ||
                    video.description.toLowerCase().includes(currentSearch.toLowerCase()) ||
                    video.tags.some(tag => tag.toLowerCase().includes(currentSearch.toLowerCase()));
                
                return matchCategory && matchSearch;
            });
            
            // æ’åº
            sortVideos();
            
            // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
            currentPage = 1;
            
            // æ›´æ–°æ˜¾ç¤º
            displayVideos();
            updateStats();
            updatePagination();
        }

        function sortVideos() {
            const sortBy = document.getElementById('sortSelect').value;
            currentSort = sortBy;
            
            filteredVideos.sort((a, b) => {
                switch(sortBy) {
                    case 'name':
                        return a.title.localeCompare(b.title, 'zh-CN');
                    case 'newest':
                        return new Date(b.uploadDate) - new Date(a.uploadDate);
                    case 'category':
                        return a.category.localeCompare(b.category, 'zh-CN');
                    default:
                        return a.id - b.id;
                }
            });
            
            displayVideos();
        }

        function searchVideos() {
            const searchInput = document.getElementById('searchInput');
            currentSearch = searchInput.value.trim();
            filterVideos();
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            currentSearch = '';
            currentCategory = 'all';
            currentSort = 'default';
            
            // æ›´æ–°UIçŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.filter-btn[data-category="all"]').classList.add('active');
            document.getElementById('sortSelect').value = 'default';
            
            filterVideos();
        }

        function showAllVideos() {
            clearFilters();
        }

        function showFeaturedVideos() {
            filteredVideos = allVideos.filter(v => v.featured);
            currentPage = 1;
            displayVideos();
            updateStats();
        }

        // ===================== æ˜¾ç¤ºå‡½æ•° =====================
        function displayVideos() {
            const container = document.getElementById('videoContainer');
            
            if (filteredVideos.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ”</div>
                        <h3 class="empty-title">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è§†é¢‘</h3>
                        <p class="empty-desc">å°è¯•ä½¿ç”¨ä¸åŒçš„æœç´¢å…³é”®è¯æˆ–ç­›é€‰æ¡ä»¶ï¼Œæˆ–è€…æŸ¥çœ‹æ‰€æœ‰è§†é¢‘ã€‚</p>
                        <button class="btn btn-primary" onclick="clearFilters()">
                            <i class="fas fa-eye"></i> æŸ¥çœ‹æ‰€æœ‰è§†é¢‘
                        </button>
                    </div>
                `;
                document.getElementById('pagination').innerHTML = '';
                return;
            }
            
            // è®¡ç®—å½“å‰é¡µçš„è§†é¢‘
            const startIndex = (currentPage - 1) * CONFIG.VIDEOS_PER_PAGE;
            const endIndex = Math.min(startIndex + CONFIG.VIDEOS_PER_PAGE, filteredVideos.length);
            const currentVideos = filteredVideos.slice(startIndex, endIndex);
            
            // ç”Ÿæˆè§†é¢‘å¡ç‰‡
            container.innerHTML = '';
            currentVideos.forEach(video => {
                const videoUrl = CONFIG.R2_PUBLIC_URL + encodeURIComponent(video.filename);
                const card = createVideoCard(video, videoUrl);
                container.appendChild(card);
            });
        }

        function createVideoCard(video, videoUrl) {
            const card = document.createElement('div');
            card.className = `video-card ${video.featured ? 'featured' : ''}`;
            
            // æ„å»ºæ ‡ç­¾HTML
            const tagsHtml = video.tags.map(tag => 
                `<span class="tag" onclick="searchByTag('${tag}')">${tag}</span>`
            ).join('');
            
            // æ„å»ºå…ƒæ•°æ®HTML
            const metaHtml = `
                <span><i class="far fa-calendar"></i> ${video.uploadDate}</span>
                ${video.duration ? `<span><i class="far fa-clock"></i> ${video.duration}</span>` : ''}
            `;
            
            card.innerHTML = `
                ${video.featured ? '<div class="video-featured-badge"><i class="fas fa-star"></i> ç²¾é€‰</div>' : ''}
                
                <div class="video-preview" onclick="playVideo('${videoUrl}', '${video.title}')">
                    <div class="play-btn-overlay">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="video-duration">${video.duration || '--:--'}</div>
                </div>
                
                <div class="video-content">
                    <div class="video-header">
                        <h3 class="video-title">${video.title}</h3>
                        <span class="video-category">${video.category}</span>
                    </div>
                    
                    <p class="video-description">${video.description}</p>
                    
                    <div class="video-tags">
                        ${tagsHtml}
                    </div>
                    
                    <div class="video-footer">
                        <div class="video-meta">
                            ${metaHtml}
                        </div>
                        
                        <div class="video-actions">
                            <button class="action-btn play" onclick="playVideo('${videoUrl}', '${video.title}')">
                                <i class="fas fa-play"></i> æ’­æ”¾
                            </button>
                            <a class="action-btn download" href="${videoUrl}" download="${video.filename}">
                                <i class="fas fa-download"></i> ä¸‹è½½
                            </a>
                        </div>
                    </div>
                </div>
            `;
            
            return card;
        }

        function searchByTag(tag) {
            document.getElementById('searchInput').value = tag;
            currentSearch = tag;
            filterVideos();
        }

        // ===================== åˆ†é¡µå‡½æ•° =====================
        function updatePagination() {
            const totalPages = Math.ceil(filteredVideos.length / CONFIG.VIDEOS_PER_PAGE);
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }
            
            let html = '';
            
            // ä¸Šä¸€é¡µæŒ‰é’®
            html += `
                <button class="page-btn ${currentPage === 1 ? 'disabled' : ''}" 
                        onclick="changePage(${currentPage - 1})" 
                        ${currentPage === 1 ? 'disabled' : ''}>
                    <i class="fas fa-chevron-left"></i>
                </button>
            `;
            
            // é¡µç æŒ‰é’®
            const maxVisible = 5;
            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, startPage + maxVisible - 1);
            
            if (endPage - startPage + 1 < maxVisible) {
                startPage = Math.max(1, endPage - maxVisible + 1);
            }
            
            if (startPage > 1) {
                html += `<button class="page-btn" onclick="changePage(1)">1</button>`;
                if (startPage > 2) {
                    html += `<span class="page-btn disabled">...</span>`;
                }
            }
            
            for (let i = startPage; i <= endPage; i++) {
                html += `
                    <button class="page-btn ${i === currentPage ? 'active' : ''}" 
                            onclick="changePage(${i})">
                        ${i}
                    </button>
                `;
            }
            
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    html += `<span class="page-btn disabled">...</span>`;
                }
                html += `<button class="page-btn" onclick="changePage(${totalPages})">${totalPages}</button>`;
            }
            
            // ä¸‹ä¸€é¡µæŒ‰é’®
            html += `
                <button class="page-btn ${currentPage === totalPages ? 'disabled' : ''}" 
                        onclick="changePage(${currentPage + 1})" 
                        ${currentPage === totalPages ? 'disabled' : ''}>
                    <i class="fas fa-chevron-right"></i>
                </button>
            `;
            
            // é¡µé¢ä¿¡æ¯
            html += `
                <span class="page-info">
                    ç¬¬ ${currentPage} / ${totalPages} é¡µ
                </span>
            `;
            
            pagination.innerHTML = html;
        }

        function changePage(page) {
            const totalPages = Math.ceil(filteredVideos.length / CONFIG.VIDEOS_PER_PAGE);
            if (page < 1 || page > totalPages) return;
            
            currentPage = page;
            displayVideos();
            updatePagination();
            
            // å¹³æ»‘æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // ===================== ç»Ÿè®¡ä¿¡æ¯ =====================
        function updateStats() {
            document.getElementById('totalCount').textContent = allVideos.length;
            document.getElementById('filteredCount').textContent = filteredVideos.length;
            document.getElementById('categoryCount').textContent = getAllCategories().length;
        }

        // ===================== è§†é¢‘æ’­æ”¾å‡½æ•° =====================
        function playVideo(videoUrl, videoTitle) {
            const modal = document.getElementById('videoModal');
            const videoPlayer = document.getElementById('videoPlayer');
            const modalTitle = document.getElementById('videoModalTitle');
            const modalInfo = document.getElementById('videoModalInfo');
            
            // è®¾ç½®è§†é¢‘æº
            videoPlayer.src = videoUrl;
            modalTitle.textContent = videoTitle;
            
            // æŸ¥æ‰¾è§†é¢‘ä¿¡æ¯
            const video = allVideos.find(v => v.title === videoTitle);
            if (video) {
                modalInfo.innerHTML = `
                    <p><strong>æè¿°:</strong> ${video.description}</p>
                    <p><strong>ç±»åˆ«:</strong> ${video.category}</p>
                    <p><strong>æ ‡ç­¾:</strong> ${video.tags.join(', ')}</p>
                    <p><strong>æ—¶é•¿:</strong> ${video.duration || 'æœªçŸ¥'}</p>
                    <p><strong>ä¸Šä¼ æ—¥æœŸ:</strong> ${video.uploadDate}</p>
                    <p><strong>æ–‡ä»¶:</strong> ${video.filename}</p>
                `;
            }
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            modal.style.display = 'flex';
            
            // å¼€å§‹æ’­æ”¾
            setTimeout(() => {
                videoPlayer.play().catch(e => console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢:', e));
            }, 300);
            
            // è®°å½•æ’­æ”¾å†å²
            recordPlayHistory(videoTitle);
        }

        function closeVideoModal() {
            const modal = document.getElementById('videoModal');
            const videoPlayer = document.getElementById('videoPlayer');
            
            videoPlayer.pause();
            videoPlayer.src = '';
            modal.style.display = 'none';
        }

        function recordPlayHistory(title) {
            let history = JSON.parse(localStorage.getItem('video_play_history') || '[]');
            
            // ç§»é™¤é‡å¤é¡¹
            history = history.filter(item => item.title !== title);
            
            // æ·»åŠ åˆ°å¼€å¤´
            history.unshift({
                title: title,
                time: new Date().toISOString(),
                timestamp: Date.now()
            });
            
            // åªä¿ç•™æœ€è¿‘20æ¡
            history = history.slice(0, 20);
            
            localStorage.setItem('video_play_history', JSON.stringify(history));
        }

        // ===================== å¯¼å‡ºåŠŸèƒ½ =====================
        function exportVideoList() {
            const data = {
                title: CONFIG.SITE_TITLE,
                totalVideos: allVideos.length,
                exportDate: new Date().toISOString(),
                videos: allVideos
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `èˆè¹ˆè§†é¢‘åˆ—è¡¨_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            alert(`å·²å¯¼å‡º ${allVideos.length} ä¸ªè§†é¢‘çš„ä¿¡æ¯åˆ°JSONæ–‡ä»¶`);
        }

        // ===================== å·¥å…·å‡½æ•° =====================
        function showLoading() {
            document.getElementById('loading').style.display = 'flex';
        }

        function hideLoading() {
            setTimeout(() => {
                document.getElementById('loading').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                }, 300);
            }, 500);
        }

        function showError(message) {
            const container = document.getElementById('videoContainer');
            container.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">âš ï¸</div>
                    <h3 class="empty-title">${message}</h3>
                    <button class="btn btn-primary" onclick="init()">
                        <i class="fas fa-redo"></i> é‡æ–°åŠ è½½
                    </button>
                </div>
            `;
        }

        function showTips() {
            if (!localStorage.getItem('tips_shown')) {
                setTimeout(() => {
                    alert('ğŸ‰ æ­å–œï¼æ‚¨çš„300ä¸ªèˆè¹ˆä½œå“ç½‘ç«™å·²å‡†å¤‡å°±ç»ªï¼\n\nğŸ’¡ ä½¿ç”¨æç¤ºï¼š\n1. ä½¿ç”¨æœç´¢æ¡†å¿«é€ŸæŸ¥æ‰¾èˆè¹ˆä½œå“\n2. ç‚¹å‡»ç±»åˆ«æŒ‰é’®ç­›é€‰ä¸åŒé£æ ¼çš„èˆè¹ˆ\n3. ç‚¹å‡»æ ‡ç­¾å¯ä»¥å¿«é€Ÿæœç´¢ç›¸å…³ä½œå“\n4. ç²¾é€‰ä½œå“æœ‰é‡‘è‰²è¾¹æ¡†æ ‡è®°\n\nç½‘ç«™ä¼šè‡ªåŠ¨ä»æ‚¨çš„R2å­˜å‚¨åŠ è½½æ‰€æœ‰è§†é¢‘ï¼');
                    localStorage.setItem('tips_shown', 'true');
                }, 1500);
            }
        }

        // ===================== äº‹ä»¶ç›‘å¬ =====================
        document.addEventListener('keydown', function(e) {
            // ESCé”®å…³é—­è§†é¢‘
            if (e.key === 'Escape') {
                closeVideoModal();
            }
            
            // ç©ºæ ¼é”®æš‚åœ/æ’­æ”¾è§†é¢‘
            if (e.key === ' ' && document.activeElement.tagName !== 'INPUT') {
                const videoPlayer = document.getElementById('videoPlayer');
                if (videoPlayer.src) {
                    e.preventDefault();
                    if (videoPlayer.paused) {
                        videoPlayer.play();
                    } else {
                        videoPlayer.pause();
                    }
                }
            }
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
        document.getElementById('videoModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeVideoModal();
            }
        });

        // ===================== åˆå§‹åŒ– =====================
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', init);
        
        // ä¿å­˜æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
        window.addEventListener('beforeunload', function() {
            localStorage.setItem('dance_video_data', JSON.stringify(allVideos));
        });
    </script>

